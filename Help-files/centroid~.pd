#N canvas 494 206 654 383 10;
#X obj 53 45 inlet~;
#X obj 140 45 inlet;
#X obj 53 167 *~;
#X obj 53 258 *~;
#X obj 230 252 /;
#X obj 230 316 outlet;
#X obj 68 235 tabreceive~ freq_\$0;
#X obj 68 145 tabreceive~ mask_\$0;
#N canvas 753 296 391 344 set 0;
#X msg 133 149 resize \$1;
#X obj 104 30 inlet;
#N canvas 334 224 446 215 mask 0;
#N canvas 0 0 450 300 (subpatch) 0;
#X array mask_\$0 1 float 3;
#A 0 0;
#X coords 0 1 1 -1 200 140 1 0 0;
#X restore 218 42 graph;
#X obj 27 59 inlet;
#X msg 27 95 resize \$1 \, const 1 \, 0 0;
#X obj 27 122 s mask_\$0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X restore 104 270 pd mask;
#X obj 104 125 f \$1;
#X obj 212 149 v sr_\$0;
#X msg 292 86 1;
#X obj 292 109 atan;
#X obj 292 133 * 8;
#X obj 292 155 v twopi;
#N canvas 745 23 450 300 hann 0;
#X msg 248 137 resize \$1;
#X obj 248 158 array define hann_\$0;
#X obj 93 150 expr hann_\$0[$f1] = cos(twopi*$f1/$f2) * -0.5 + 0.5
, f 20;
#X obj 93 93 trigger float float;
#N canvas 750 289 307 233 loop 0;
#X obj 73 44 inlet;
#X obj 73 113 until;
#X obj 73 83 t f b;
#X obj 112 144 f;
#X obj 112 169 outlet;
#X msg 127 115 0;
#X obj 143 144 + 1;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 2 1 5 0;
#X connect 3 0 4 0;
#X connect 3 0 6 0;
#X connect 5 0 3 1;
#X connect 6 0 3 1;
#X restore 93 123 pd loop;
#X obj 93 66 inlet;
#X connect 0 0 1 0;
#X connect 3 0 4 0;
#X connect 3 1 0 0;
#X connect 3 1 2 1;
#X connect 4 0 2 0;
#X connect 5 0 3 0;
#X restore 83 294 pd hann;
#X obj 113 78 loadbang;
#X obj 212 125 samplerate~;
#X obj 133 205 array define weighted_f_\$0;
#X obj 143 184 array define amps_\$0;
#X obj 113 100 trigger bang bang;
#N canvas 401 271 578 257 frequencies 0;
#N canvas 0 0 450 300 (subpatch) 0;
#X array freq_\$0 1 float 2;
#X coords 0 44100 1 0 200 140 1 0 0;
#X restore 288 50 graph;
#X obj 57 18 inlet;
#X msg 191 108 resize \$1;
#X obj 57 121 expr freq_\$0[$f1] = $f1 * sr_\$0 / $f2, f 19;
#X obj 57 72 trigger float float;
#N canvas 750 289 307 233 loop 0;
#X obj 73 44 inlet;
#X obj 73 113 until;
#X obj 73 83 t f b;
#X obj 112 144 f;
#X obj 112 169 outlet;
#X msg 127 115 0;
#X obj 143 144 + 1;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 2 1 5 0;
#X connect 3 0 4 0;
#X connect 3 0 6 0;
#X connect 5 0 3 1;
#X connect 6 0 3 1;
#X restore 57 95 pd loop;
#X obj 191 130 s freq_\$0;
#X connect 1 0 4 0;
#X connect 2 0 6 0;
#X connect 4 0 5 0;
#X connect 4 1 3 1;
#X connect 4 1 2 0;
#X connect 5 0 3 0;
#X restore 119 246 pd frequencies;
#X connect 0 0 12 0;
#X connect 0 0 13 0;
#X connect 1 0 3 0;
#X connect 3 0 15 0;
#X connect 3 0 2 0;
#X connect 3 0 0 0;
#X connect 3 0 9 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 8 0;
#X connect 10 0 14 0;
#X connect 11 0 4 0;
#X connect 14 0 3 0;
#X connect 14 1 11 0;
#X connect 14 1 5 0;
#X restore 140 91 pd set \; init;
#X obj 209 118 block~ \$1 \$2;
#N canvas 748 504 327 282 fft 0;
#X obj 113 107 rfft~;
#X obj 140 137 *~;
#X obj 125 165 +~;
#X obj 125 191 sqrt~;
#X obj 125 218 outlet~;
#X obj 113 137 *~;
#X obj 113 44 inlet~;
#X obj 113 78 *~;
#X obj 145 78 tabreceive~ hann_\$0;
#X connect 0 0 5 0;
#X connect 0 0 5 1;
#X connect 0 1 1 0;
#X connect 0 1 1 1;
#X connect 1 0 2 1;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 2 0;
#X connect 6 0 7 0;
#X connect 7 0 0 0;
#X connect 8 0 7 1;
#X restore 53 91 pd fft;
#X obj 209 77 list prepend set;
#X obj 209 98 list trim;
#X obj 68 197 tabsend~ amps_\$0;
#X obj 237 200 array sum amps_\$0;
#X obj 210 227 array sum weighted_f_\$0;
#X obj 53 286 tabsend~ weighted_f_\$0;
#X text 81 168 remove DC;
#X obj 210 153 bang~;
#X obj 210 175 t b b;
#X text 359 111 Alexandre Torres Porres (2019);
#X text 357 130 Part of PSYCHO \; https://github.com/porres/pd-psycho
;
#X connect 0 0 10 0;
#X connect 1 0 8 0;
#X connect 1 0 11 0;
#X connect 2 0 3 0;
#X connect 2 0 13 0;
#X connect 3 0 16 0;
#X connect 4 0 5 0;
#X connect 6 0 3 1;
#X connect 7 0 2 1;
#X connect 10 0 2 0;
#X connect 11 0 12 0;
#X connect 12 0 9 0;
#X connect 14 0 4 1;
#X connect 15 0 4 0;
#X connect 18 0 19 0;
#X connect 19 0 15 0;
#X connect 19 1 14 0;
